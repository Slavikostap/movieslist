!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["angular"],t):e.hasOwnProperty("angular")?t(e.angular):"object"==typeof exports&&(module.exports=t(require("angular")))}(this,function(e){"use strict";function t(e,t){var r;try{r=e[t]}catch(n){r=!1}if(r&&"localStorage"===t){var o="__"+Math.round(1e7*Math.random());try{localStorage.setItem(o,o),localStorage.removeItem(o)}catch(n){r=!1}}return r}function r(r){var n=t(window,r);return function(){var o="ngStorage-";this.setKeyPrefix=function(e){if("string"!=typeof e)throw new TypeError("[ngStorage] - "+r+"Provider.setKeyPrefix() expects a String.");o=e};var i=e.toJson,a=e.fromJson;this.setSerializer=function(e){if("function"!=typeof e)throw new TypeError("[ngStorage] - "+r+"Provider.setSerializer expects a function.");i=e},this.setDeserializer=function(e){if("function"!=typeof e)throw new TypeError("[ngStorage] - "+r+"Provider.setDeserializer expects a function.");a=e},this.supported=function(){return!!n},this.get=function(e){return n&&a(n.getItem(o+e))},this.set=function(e,t){return n&&n.setItem(o+e,i(t))},this.$get=["$rootScope","$window","$log","$timeout","$document",function(n,s,u,c,f){var l,p,d=o.length,g=t(s,r),y=g||(u.warn("This browser does not support Web Storage!"),{setItem:e.noop,getItem:e.noop,removeItem:e.noop}),v={$default:function(t){for(var r in t)e.isDefined(v[r])||(v[r]=e.copy(t[r]));return v.$sync(),v},$reset:function(e){for(var t in v)"$"===t[0]||delete v[t]&&y.removeItem(o+t);return v.$default(e)},$sync:function(){for(var e,t=0,r=y.length;r>t;t++)(e=y.key(t))&&o===e.slice(0,d)&&(v[e.slice(d)]=a(y.getItem(e)))},$apply:function(){var t;if(p=null,!e.equals(v,l)){t=e.copy(l),e.forEach(v,function(r,n){e.isDefined(r)&&"$"!==n[0]&&(y.setItem(o+n,i(r)),delete t[n])});for(var r in t)y.removeItem(o+r);l=e.copy(v)}},$supported:function(){return!!g}};return v.$sync(),l=e.copy(v),n.$watch(function(){p||(p=c(v.$apply,100,!1))}),s.addEventListener&&s.addEventListener("storage",function(t){if(t.key){var r=f[0];r.hasFocus&&r.hasFocus()||o!==t.key.slice(0,d)||(t.newValue?v[t.key.slice(d)]=a(t.newValue):delete v[t.key.slice(d)],l=e.copy(v),n.$apply())}}),s.addEventListener&&s.addEventListener("beforeunload",function(){v.$apply()}),v}]}}return e=e&&e.module?e:window.angular,e.module("ngStorage",[]).provider("$localStorage",r("localStorage")).provider("$sessionStorage",r("sessionStorage"))});